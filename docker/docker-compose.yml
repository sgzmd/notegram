version: "3.9"

services:
  notegram:
    build:
      context: ..
      dockerfile: docker/Dockerfile
    env_file:
      - .env
      - ../.env
    environment:
      - WHISPER_MODEL_PATH=/models/ggml-model.bin
      - FFMPEG_CMD=${FFMPEG_CMD:-ffmpeg}
    volumes:
      - ../models:/models:ro
    command:
      - "--telegram_token"
      - "${TELEGRAM_TOKEN:?TELEGRAM_TOKEN not set}"
      - "--allowed_users"
      - "${ALLOWED_USERS:?ALLOWED_USERS not set}"
      - "--assemblyai_token"
      - "${ASSEMBLYAI_TOKEN:?ASSEMBLYAI_TOKEN not set}"
      - "--gemini_token"
      - "${GEMINI_TOKEN:?GEMINI_TOKEN not set}"
    restart: unless-stopped
